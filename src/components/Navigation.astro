---
interface Props {
  currentPath?: string;
  transparent?: boolean;
}

const { currentPath = '/', transparent = false } = Astro.props;

const navLinks = [
  { href: '/systems', label: '対応システム' },
  { href: '/simulator', label: '見積もり' },
  { href: '/blog', label: 'ブログ' },
  { href: '/cases', label: '開発事例' },
  { href: '/about', label: '会社概要' },
];

const isActive = (href: string) => currentPath === href;
---

<nav id="main-nav" class:list={[
  "fixed top-0 left-0 right-0 z-50 transition-all duration-300",
  transparent ? "bg-transparent" : "bg-[#0A1628]/95 backdrop-blur-md border-b border-white/5"
]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 py-3 sm:py-4">
    <div class="flex items-center justify-between">
      <a href="/" class="flex items-center gap-2 sm:gap-3 group">
        <img
          src="/logo.svg"
          alt="TechTime"
          class="h-8 sm:h-10 w-auto"
        />
      </a>

      <!-- Desktop Menu -->
      <div class="hidden lg:flex items-center gap-6 xl:gap-8">
        {navLinks.map((link) => (
          <a
            href={link.href}
            class:list={[
              "text-sm transition-colors whitespace-nowrap",
              isActive(link.href) ? "text-[#00D9FF] font-medium" : "text-gray-300 hover:text-[#00D9FF]"
            ]}
          >
            {link.label}
          </a>
        ))}
        <a
          href="/contact"
          class="px-4 xl:px-6 py-2 bg-gradient-to-r from-[#00D9FF] to-[#0099FF] text-white font-medium rounded-lg hover:shadow-lg hover:shadow-[#00D9FF]/30 transition-all duration-300 whitespace-nowrap text-sm"
        >
          お問い合わせ
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <button
        id="mobile-menu-btn"
        class="lg:hidden text-white p-2"
        aria-label="メニューを開く"
      >
        <i class="ri-menu-line text-2xl" id="menu-icon"></i>
      </button>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden lg:hidden bg-[#0A1628]/98 backdrop-blur-xl border-t border-white/10">
    <div class="max-w-7xl mx-auto px-4 py-4 space-y-1">
      {navLinks.map((link) => (
        <a
          href={link.href}
          class:list={[
            "block px-4 py-3 rounded-lg transition-colors",
            isActive(link.href)
              ? "text-[#00D9FF] font-medium hover:bg-white/5"
              : "text-gray-300 hover:text-[#00D9FF] hover:bg-white/5"
          ]}
        >
          {link.label}
        </a>
      ))}
      <a
        href="/contact"
        class="block mx-4 my-2 px-4 py-3 bg-gradient-to-r from-[#00D9FF] to-[#0099FF] text-white font-medium rounded-lg hover:shadow-lg hover:shadow-[#00D9FF]/30 transition-all duration-300 text-center"
      >
        お問い合わせ
      </a>
    </div>
  </div>
</nav>

<script>
  // Mobile menu toggle
  const menuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');
  const menuIcon = document.getElementById('menu-icon');

  menuBtn?.addEventListener('click', () => {
    const isOpen = !mobileMenu?.classList.contains('hidden');
    mobileMenu?.classList.toggle('hidden');
    if (menuIcon) {
      menuIcon.className = isOpen ? 'ri-menu-line text-2xl' : 'ri-close-line text-2xl';
    }
  });

  // Scroll effect for transparent nav
  const nav = document.getElementById('main-nav');
  if (nav?.classList.contains('bg-transparent')) {
    window.addEventListener('scroll', () => {
      if (window.scrollY > 50) {
        nav.classList.remove('bg-transparent');
        nav.classList.add('bg-[#0A1628]/95', 'backdrop-blur-md', 'shadow-lg');
      } else {
        nav.classList.add('bg-transparent');
        nav.classList.remove('bg-[#0A1628]/95', 'backdrop-blur-md', 'shadow-lg');
      }
    });
  }
</script>
